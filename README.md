## J-Quants APIを使用したPER、PBRの算出検証コード

APIのリンク https://jpx-jquants.com/

## 設定 J-Quants APIのリフレッシュトークンを環境変数に設定

```
export REFRESH_TOKEN=""
```

## [1] EPSとBPSを取得

```
python3 getfinStatements.py 7832
```

## [2] [1]をTSEライブラリを使用して銘柄名から実行可能にする

```
python3 getfinStatements2.py 任天堂
```

```
DisclosedDate NetSales          OperatingProfit OrdinaryProfit  Profit          EarningsPerShare BookValuePerShare
2022-05-10    1,695,344,000,000 592,760,000,000 670,813,000,000 477,691,000,000 4046.69          17635.6
2022-08-03      307,460,000,000 101,647,000,000 166,723,000,000 118,984,000,000 1018.55
2022-11-08      656,974,000,000 220,387,000,000 322,464,000,000 230,451,000,000  197.61
2023-02-07    1,295,178,000,000 410,541,000,000 482,580,000,000 346,227,000,000  297.05
2023-05-09    1,601,677,000,000 504,375,000,000 601,070,000,000 432,768,000,000  371.41          1946.55
2023-08-03      461,341,000,000 185,441,000,000 253,766,000,000 181,019,000,000  155.48
2023-11-07      796,237,000,000 279,910,000,000 380,007,000,000 271,298,000,000  233.03
2024-02-06    1,394,796,000,000 464,410,000,000 567,357,000,000 408,041,000,000  350.48
```

## [3] PER算出 

```
python3 getPer.py 任天堂
```

```
DisclosedDate NetSales          OperatingProfit OrdinaryProfit  Profit          EarningsPerShare BookValuePerShare ClosingPrice PER
2022-05-10    1,695,344,000,000 592,760,000,000 670,813,000,000 477,691,000,000 4046.69          17635.6           56,360       13
2022-08-03      307,460,000,000 101,647,000,000 166,723,000,000 118,984,000,000 1018.55                            56,700       55
2022-11-08      656,974,000,000 220,387,000,000 322,464,000,000 230,451,000,000  197.61                             6,225       31
2023-02-07    1,295,178,000,000 410,541,000,000 482,580,000,000 346,227,000,000  297.05                             5,624       18
2023-05-09    1,601,677,000,000 504,375,000,000 601,070,000,000 432,768,000,000  371.41          1946.55            5,730       15
2023-08-03      461,341,000,000 185,441,000,000 253,766,000,000 181,019,000,000  155.48                             6,357       40
2023-11-07      796,237,000,000 279,910,000,000 380,007,000,000 271,298,000,000  233.03                             6,385       27
2024-02-06    1,394,796,000,000 464,410,000,000 567,357,000,000 408,041,000,000  350.48                             8,376       23
```

## [4] PBRとPER算出 

```
python3 getPerPbr.py 西日本旅客鉄道
```

```
DisclosedDate NetSales          OperatingProfit  OrdinaryProfit   Profit           EarningsPerShare BookValuePerShare ClosingPrice PER  PBR
2022-04-28    1,031,103,000,000 -119,091,000,000 -121,047,000,000 -113,198,000,000 -516.06          3973.15           4,844        -9.4 1.22
2022-08-02      297,144,000,000   19,535,000,000   16,914,000,000   57,872,000,000   237.4                            4,958        20.9 None
2022-11-01      616,705,000,000   33,854,000,000   27,705,000,000   64,517,000,000  264.71                            5,885        22.2 None
2023-01-31      974,845,000,000   69,995,000,000   59,833,000,000   87,372,000,000   358.5                            5,435        15.2 None
2023-04-28    1,395,531,000,000   83,970,000,000   73,619,000,000   88,528,000,000  363.26          4245.13           5,891        16.2 1.39
2023-08-01      369,270,000,000   52,210,000,000   48,632,000,000   33,313,000,000  136.71                            5,899        43.1 None
2023-10-31      769,902,000,000  106,292,000,000   98,458,000,000   67,143,000,000  275.52                            5,746        20.9 None
2023-10-31                                                                                                            5,746        None None
2024-01-31    1,194,322,000,000  172,446,000,000  161,033,000,000  109,888,000,000  450.92                            6,150        13.6 None
2024-01-31                                                                                                            6,150        None None
```